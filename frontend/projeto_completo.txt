

--- ARQUIVO: src/main.ts ---

import { CandidatoController } from "./controllers/candidato.controller";
import { EmpresaController } from "./controllers/empresa.controller";
import { VagaController } from "./controllers/vaga.controller";

const path = window.location.pathname;

if (path.includes("cadastro-empresa.html")){
    new EmpresaController();
} else if (path.includes("cadastro-candidato.html")){
    new CandidatoController();
} else if (path.includes("empresa/vagas.html")){
    new VagaController();
} else if (path.includes("empresa/perfil.html")){
    const empresaCtrl = new EmpresaController();
    if(typeof empresaCtrl.initDashboard === 'function'){
        empresaCtrl.initDashboard();
    } else {
        console.warn("Erro ao iniciar dashboard");
    }    
} else if (path.includes("candidato/perfil.html")){
    const candidatoCtrl = new CandidatoController();
    candidatoCtrl.renderPerfil();
} else if (path.includes("candidato/vagas.html")){
    const vagaCtrl = new VagaController();
    if(typeof vagaCtrl.listarVagasDisponiveis === 'function'){
        vagaCtrl.listarVagasDisponiveis();
    }
} else {
    console.warn("Nenhum controller configurado para essa página");
}

--- ARQUIVO: src/models/empresa.ts ---

export interface Empresa {
    nome: string
    email: string
    cnpj: string
    pais: string
    estado: string
    cep: string
    descricao: string
}

--- ARQUIVO: src/models/candidato.ts ---

export interface Candidato{
    cpf: string
    idade: number
    estado: string
    cep: string
    descricao: string
    nome: string
    email: string
    competencias: string[]
}

--- ARQUIVO: src/models/vaga.ts ---

import type { Empresa } from "./empresa";



export interface Vaga {
    id: string
    titulo: string
    descricao: string
    pais: string
    estado: string
    competencias: string[]
    salario: number
    empresa: Empresa
}

--- ARQUIVO: src/controllers/vaga.controller.ts ---

import { Empresa } from "../models/empresa";
import { Vaga } from "../models/vaga";
import { VagaService } from "../services/vagaService";

export class VagaController{

    private service: VagaService;

    constructor(){
        this.service = new VagaService;
        this.verificarLogin();
        this.configurarForm();
    }

    public configurarForm(){
        const form = document.getElementById("form-vaga") as HTMLFormElement;

        if(form){
            form.addEventListener("submit", (e) => this.salvarVaga(e));
        }
    }

    public verificarLogin(){
        const empresaLogada = localStorage.getItem("empresaLogada");

        if(!empresaLogada){
            alert("Você precisa estar logado como empresa!");
            window.location.href = "/cadastro-empresa.html";
        }
    }

    public salvarVaga(e: Event){
            e.preventDefault();
    
            const empresaStorage = localStorage.getItem("empresaLogada");

            if(!empresaStorage){
                alert("Sessão inválida.");
                return;
            }

            const empresaSessao: Empresa = JSON.parse(empresaStorage);

            const tituloInput = document.getElementById("titulo") as HTMLInputElement;
            const descricaoInput = document.getElementById("descricao") as HTMLInputElement;
            const paisInput = document.getElementById("pais") as HTMLInputElement;
            const estadoInput = document.getElementById("estado") as HTMLInputElement;
            const competenciasInput = document.getElementById("competencias") as HTMLInputElement;
            const salarioInput = document.getElementById("salario") as HTMLInputElement;


            const novaVaga: Vaga = {
                id: crypto.randomUUID(),
                titulo: tituloInput.value,
                descricao: descricaoInput.value,
                pais: paisInput.value,
                estado: estadoInput.value,
                competencias: (competenciasInput.value).split(",").map(c => c.trim()),
                salario: parseInt(salarioInput.value) || 0,
                empresa: empresaSessao
            }

            try {
            this.service.add(novaVaga);

            alert("Vaga Criada!")

            window.location.href = "empresa/perfil.html";
            } catch (error) {
                alert(error);
            }


        }
        

    public listarVagasDisponiveis(){
        const listaElement = document.getElementById("lista-vagas");
        if(!listaElement) return;

        const vagas = this.service.listAll();

        if(vagas.length === 0){
            listaElement.innerHTML = "<p>Nenhuma vaga disponível no momento</p>"
            return
        }

        vagas.forEach(vaga => {
            const div = document.createElement("div");

            div.className = "vaga-card";

            const tagsHtml = vaga.competencias .map(skill => `<span class="tag">${skill}</span>`) .join("");

            div.innerHTML = `
                <div class="vaga-titulo">${vaga.titulo}</div>
                <p>${vaga.descricao}</p>
                <div class="tags"><strong>Requisitos:</strong> ${tagsHtml}</div>
                <p><strong>Salário:</strong> R$ ${vaga.salario.toFixed(2)}</p>
                <button onclick="alert('Inscrição realizada!')">Aplicar</button>
            `;

            listaElement.appendChild(div);

        })

    }
    

}

--- ARQUIVO: src/controllers/empresa.controller.ts ---

import { Empresa } from "../models/empresa";
import { CandidatoService } from "../services/candidatoService";
import { EmpresaService } from "../services/empresaService";


export class EmpresaController{

    private service: EmpresaService;

    constructor(){
        this.service = new EmpresaService();
        this.configurarForm();
    }

    public initDashboard(){
        const candidatoService = new CandidatoService();
        const candidatos = candidatoService.listAll();

        const tbody = document.querySelector("#tabela-candidatos tbody");
        if(tbody){
            tbody.innerHTML = "";

            candidatos.forEach((candidato, index) =>{
                const tr = document.createElement("tr");
                tr.innerHTML = `
                    <td>Candidato #${index + 1}</td>
                    <td>${candidato.competencias.join(", ")}</td>
                `;
                tbody.appendChild(tr);
            });
        }

        const canvas = document.getElementById("grafico-competencias") as HTMLCanvasElement;
        if(canvas && candidatos.length > 0){
            const count: Record<string, number> = {};
            candidatos.forEach(c => {
                c.competencias.forEach(skill => {
                    const s = skill.toUpperCase().trim();
                    count[s] = (count[s] || 0) + 1;
                });
            });

            // @ts-ignore
            new Chart(canvas, {
                type: 'bar',
                data: {
                    labels: Object.keys(count),
                    datasets: [{
                        label: '# de candidatos',
                        data: Object.values(count),
                        backgroundColor: 'rgba(54, 162, 235, 0.6)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: { beginAtZero: true, ticks: { stepSize: 1 } }
                    }
                }
            });

        }

    }

    public configurarForm(){
        const form = document.getElementById("form-empresa") as HTMLFormElement;

        if(form){
            form.addEventListener("submit", (e) => this.salvarEmpresa(e));
        }
    }

    public salvarEmpresa(e: Event){
        e.preventDefault();

        const nomeInput = document.getElementById("nome") as HTMLInputElement;
        const cnpjInput = document.getElementById("cnpj") as HTMLInputElement;
        const emailInput = document.getElementById("email") as HTMLInputElement;
        const descricaoInput = document.getElementById("descricao") as HTMLInputElement;
        const paisInput = document.getElementById("pais") as HTMLInputElement;
        const estadoInput = document.getElementById("estado") as HTMLInputElement;
        const cepInput = document.getElementById("cep") as HTMLInputElement;

        const novaEmpresa: Empresa = {
            nome: nomeInput.value,
            cnpj: cnpjInput.value,
            email: emailInput.value,
            descricao: descricaoInput.value,
            pais: paisInput.value,
            estado: estadoInput.value,
            cep: cepInput.value
        } 

        try {
            this.service.add(novaEmpresa);

            localStorage.setItem("empresaLogada", JSON.stringify(novaEmpresa));

            alert("Cadastro Realizado!")

            window.location.href = "./empresa/perfil.html";
        } catch (error) {
            alert(error);
        }

    }

}

--- ARQUIVO: src/controllers/candidato.controller.ts ---

import { Candidato } from "../models/candidato";
import { CandidatoService } from "../services/candidatoService";


export class CandidatoController{

    private service: CandidatoService;

    constructor(){
        this.service = new CandidatoService();
        this.configurarForm();
    }

    private configurarForm(){
        const form = document.getElementById("form-candidato") as HTMLFormElement;

        if(form){
            form.addEventListener("submit", (e) => this.salvarCandidato(e));
        }
    }

    public renderPerfil(){
        const storage = localStorage.getItem("candidatoLogado");
        if(!storage) return;

        const candidato = JSON.parse(storage);
        const div = document.getElementById("dados-perfil");

        if(div){
            div.innerHTML = `
                <p><strong>Nome:</strong> ${candidato.nome}</p>
                <p><strong>Email:</strong> ${candidato.email}</p>
                <p><strong>Competências:</strong> ${candidato.competencias.join(", ")}</p>
            `;
        }
    }

    private salvarCandidato(e: Event){
        e.preventDefault();

        const nomeInput = document.getElementById("nome") as HTMLInputElement;
        const idadeInput = document.getElementById("idade") as HTMLInputElement;
        const cpfInput = document.getElementById("cpf") as HTMLInputElement;
        const emailInput = document.getElementById("email") as HTMLInputElement;
        const descricaoInput = document.getElementById("descricao") as HTMLInputElement;
        const estadoInput = document.getElementById("estado") as HTMLInputElement;
        const cepInput = document.getElementById("cep") as HTMLInputElement;
        const competenciasInput = document.getElementById("competencias") as HTMLInputElement;

        const novoCandidato: Candidato = {
            nome: nomeInput.value,
            idade: parseInt(idadeInput.value),
            cpf: cpfInput.value,
            email: emailInput.value,
            descricao: descricaoInput.value,
            estado: estadoInput.value,
            cep: cepInput.value,
            competencias: (competenciasInput.value).split(",").map(c => c.trim())
        } 

        try {
            this.service.add(novoCandidato);

            localStorage.setItem("candidatoLogado", JSON.stringify(novoCandidato));

            alert("Cadastro Realizado!")

            window.location.href = "./candidato/perfil.html";
        } catch (error) {
            alert(error);
        }

    }

}

--- ARQUIVO: src/views/cadastro-empresa.html ---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Empresa</title>
</head>
<body>

    <h1>Cadastrar Nova Empresa</h1>
    
    <form id="form-empresa">

        <input type="text" name="nome" id="nome" placeholder="Nome da Empresa">
        <input type="text" name="cnpj" id="cnpj" placeholder="CNPJ (Apenas números)">
        <input type="text" name="email" id="email" placeholder="Email">
        <input type="text" name="descricao" id="descricao" placeholder="Descrição da Empresa">
        <input type="text" name="pais" id="pais" placeholder="País">
        <input type="text" name="estado" id="estado" placeholder="Estado">
        <input type="text" name="cep" id="cep" placeholder="CEP">

        <button type="submit">Cadastrar</button>

    </form>


    <script type="module" src="../main.js"></script>
</body>
</html>

--- ARQUIVO: src/views/empresa/vagas.html ---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vagas</title>
</head>
<body>
    <h1>Cadastrar Nova Vaga</h1>

    <form id="form-vaga">

        <input type="text" name="titulo" id="titulo" placeholder="Título da Vaga">
        <input type="text" name="descricao" id="descricao" placeholder="Descrição da Vaga">
        <input type="text" name="pais" id="pais" placeholder="País">
        <input type="text" name="estado" id="estado" placeholder="Estado">
        <input type="text" name="competencias" id="competencias" placeholder="Competências (Separadas por vírgula)">
        <input type="number" name="salario" id="salario" placeholder="Salário">

        <button>Publicar Vaga</button>

    </form>

    <script type="module" src="../../main.js"></script>
</body>
</html>

--- ARQUIVO: src/views/empresa/perfil.html ---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfil</title>
</head>
<body>
    
    <h1>Perfil Empresa</h1>

    <a href="/empresa/vagas.html" class="btn" style="background-color: #007bff; color: white; padding: 10px; text-decoration: none; border-radius: 5px; display: inline-block; margin-bottom: 15px;">
        Publicar Nova Vaga
    </a>

    <div class="container">

        <div class="card">

            <h3>Candidatos Disponíveis</h3>
            <table id="tabela-candidatos">
                <thead>
                    <tr>
                        <th>Candidato</th>
                        <th>Competências</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>

        </div>

        <div class="card">
            <h3>Competências</h3>
            <canvas id="grafico-competencias"></canvas>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="../../main.js"></script>

</body>
</html>

--- ARQUIVO: src/views/candidato/vagas.html ---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vagas Disponíveis</title>
</head>
<body>
    <h1>Vagas para você</h1>
    <div id="lista-vagas">

    </div>

    <script type="module" src="../../main.js"></script>
</body>
</html>

--- ARQUIVO: src/views/candidato/perfil.html ---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Perfil</title>
</head>
<body>
    <h1>Meu Perfil</h1>

    <div id="dados-perfil">

    </div>
    <br>
    <a href="/candidato/vagas.html">Ver Vagas Disponíveis</a>

    <script type="module" src="../../main.js"></script>
</body>
</html>

--- ARQUIVO: src/views/cadastro-candidato.html ---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Candidato</title>
</head>
<body>
    <h1>Cadastrar Novo Candidato</h1>

    <form id="form-candidato">

        <input type="text" name="nome" id="nome" placeholder="Nome Completo">
        <input type="number" name="idade" id="idade" placeholder="Idade">
        <input type="text" name="cpf" id="cpf" placeholder="CPF (Apenas números)">
        <input type="text" name="email" id="email" placeholder="Email">
        <input type="text" name="descricao" id="descricao" placeholder="Descrição Profissional">
        <input type="text" name="estado" id="estado" placeholder="Estado">
        <input type="text" name="cep" id="cep" placeholder="CEP">
        <input type="text" name="competencias" id="competencias" placeholder="Competências (Separadas por vírgula)">

        <button type="submit">Cadastrar</button>

    </form>


    <script type="module" src="../main.js"></script>
</body>
</html>

--- ARQUIVO: src/services/empresaService.ts ---

import type { Empresa } from "../models/empresa";

export class EmpresaService{
    private empresas: Empresa[] = [];

    constructor(){
        const dadosSalvos = localStorage.getItem('empresas');
        if(dadosSalvos){
            this.empresas = JSON.parse(dadosSalvos);
        }
    }

    public listAll(): Empresa[]{
        return this.empresas;
    }

    public getByCnpj(cnpjToFind: string): Empresa | undefined{

        return this.empresas.find(e => e.cnpj === cnpjToFind);

    }

    public add(newEmpresa: Empresa): string{
        const exists = this.empresas.find(c => c.cnpj === newEmpresa.cnpj);
        if(exists) throw new Error("Cnpj já cadastrado.");

        this.empresas.push(newEmpresa);

        localStorage.setItem('empresas', JSON.stringify(this.empresas));

        return "Cadastro realizado";        

    }

    public delete(cnpjEmpresa: string): string{
        
        const empresaDeletar = this.getByCnpj(cnpjEmpresa);
        if(!empresaDeletar) throw new Error("Empresa não existe.");

        this.empresas =  this.empresas.filter(d => d.cnpj !== cnpjEmpresa);

        localStorage.setItem('empresas', JSON.stringify(this.empresas));

        return "Empresa " + empresaDeletar.nome + " deletada.";

    }



}

--- ARQUIVO: src/services/vagaService.ts ---

import type { Vaga } from "../models/vaga";

export class VagaService{
    private vagas: Vaga[] = [];

    constructor(){
        const dadosSalvos = localStorage.getItem('vagas');
        if(dadosSalvos){
            this.vagas = JSON.parse(dadosSalvos);
        }
    }

    public listAll(): Vaga[]{
        return this.vagas;
    }

    public getById(idToFind: string): Vaga | undefined{

        return this.vagas.find(v => v.id === idToFind);;

    }

    public add(newVaga: Vaga): string{
        const exists = this.vagas.find(v => v.id === newVaga.id);
        if(exists) throw new Error("Vaga já cadastrada.");

        this.vagas.push(newVaga);

        localStorage.setItem('vagas', JSON.stringify(this.vagas));

        return "Cadastro realizado";

    }

    public delete(idVaga: string): string{
        
        const vagaDeletar = this.getById(idVaga);
        if(!vagaDeletar) throw new Error("Vaga não existe.");

        this.vagas =  this.vagas.filter(d => d.id !== idVaga);

        localStorage.setItem('vagas', JSON.stringify(this.vagas));

        return "Vaga " + vagaDeletar.titulo + " deletada.";

    }



}

--- ARQUIVO: src/services/candidatoService.ts ---

import type { Candidato } from "../models/candidato";

export class CandidatoService{
    private candidatos: Candidato[] = [];

    constructor(){
        const dadosSalvos = localStorage.getItem('candidatos');
        if(dadosSalvos){
            this.candidatos = JSON.parse(dadosSalvos);
        }
    }

    public listAll(): Candidato[]{
        return this.candidatos;
    }

    public getByCpf(cpfToFind: string): Candidato | undefined{

        return this.candidatos.find(c => c.cpf === cpfToFind);

    }

    public add(newCandidato: Candidato): string{
        const exists = this.candidatos.find(c => c.cpf === newCandidato.cpf);
        if(exists) throw new Error("CPF já cadastrado.");

        this.candidatos.push(newCandidato);

        localStorage.setItem('candidatos', JSON.stringify(this.candidatos));

        return "Cadastro realizado";

    }

    public delete(cpfCandidato: string): string{
        
        const candidatoDeletar = this.getByCpf(cpfCandidato);
        if(!candidatoDeletar) throw new Error("Usuário não existe.");

        this.candidatos =  this.candidatos.filter(d => d.cpf !== cpfCandidato);

                localStorage.setItem('candidatos', JSON.stringify(this.candidatos));

        return "Usuário " + candidatoDeletar.nome + " deletado.";

    }



}